<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>История МФТИ</title>
    <link rel="stylesheet" href="index.css">


    <!-- Important Owl stylesheet -->
    <link rel="stylesheet" href="owl-carousel/owl.carousel.css">

    <!-- Default Theme -->
    <link rel="stylesheet" href="owl-carousel/owl.theme.css">

    <link rel="stylesheet" href="owl-carousel-test.css">

    <script
            src="https://code.jquery.com/jquery-3.1.0.min.js"
            integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="
            crossorigin="anonymous"></script>

    <!-- Include js plugin -->
    <script src="owl-carousel/owl.carousel.js"></script>


    <!-- Styles and scrypts for timeline -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.css" rel="stylesheet" type="text/css" />

    <!-- Library for work with files -->
    <script src="js-libs/moment.min.js"></script>

    <!-- Library for work with Parse -->
    <script src="//www.parsecdn.com/js/parse-1.6.14.min.js"></script>

    <link rel="stylesheet" href="timeline.css">

    <style type="text/css">
        .vis-item {
            /*background-color: #c3c3c3;*/
            background-color: rgba(195, 195, 195, 0.3);
            opacity: 0.7;
        }
        .vis-item.vis-selected {
            /*background-color: #ead7b5;*/
            background-color: rgba(195, 195, 195, 1);
            border-color: gray;
            opacity: 1;
        }
        .vis-time-axis.vis-foreground {
            /*background-color: #ead7b5;*/
            background-color: rgba(45, 131, 211, 0.58);
        }
        .vis-timeline {
            border: none;
        }
        .vis-panel.vis-center {
            border: none;
        }
        .vis-item.vis-selected:hover {
            background-color: rgba(195, 195, 195, 0.3);
            opacity: 0.7;
        }
    </style>
</head>
<body>
<img src="glavnaya.jpg" class="back">
<div class="wrapper">
    <div class="head-wrapper">
    <div class="header">
        <div class="epigraph">
            <p>
                Sapere Aude!
            </p>
        </div>

        <div class="head">
            <img src="ffke.png" alt="Лого факультетов">
            <img src="fpfe.png" alt="Лого факультетов">
            <img src="fbmf.png" alt="Лого факультетов">
            <img src="frtk.png" alt="Лого факультетов">
            <img src="falt.png" alt="Лого факультетов">
            <img src="fffi.png" alt="Лого факультетов">
            <img src="ffii.png" alt="Лого факультетов">
            <img src="faki.png" alt="Лого факультетов">
            <img src="rus_inversion.png" alt="Лого МФТИ">
        </div>
    </div>
    </div>


<!--    <div id="histry-slider" class="owl-carousel owl-theme">
        <div class="history-date">1958</div>
        <article class="history-event">
            <img class="event-img" src="00014.jpg">
            <div class="bracket"></div>
            <div class="text">
                <p>Вышел первый номер многотиражки «За науку».
                    Напечатаны первые два выпуска «Трудов МФТИ». Построена первая столовая (нынешний спортивный корпус №2).
                    Игорь Тамм получил Нобелевскую премию по физике за открытие и истолкование эффекта Черенкова.</p>
            </div>
        </article>
        <div class="history-date">1958</div>
        <article class="history-event">
            <img src="00014.jpg">
            <br>
            <p>Лабораторный корпус был основан в 1951 году и он такой весь красивый был,
                а потом его, гады застроили, и было очень грустно. Такой есимпатичный он стоял до 2012 года,
                когда его наконец сделали миленким и с большой белой лестницей в центре. Теперь там проходят легендарные ежегодные сливы Овчинкина,
                чему вся молодежь несказанно рада.</p>
        </article>
        <div class="history-date">1958</div>
        <article class="history-event">
            <img src="img_portrait_1.jpg">
            <br>
            <p>1959 — Создана киностудия «МФТИ-фильм». Организована вечерняя физико-математическая школа.</p>
        </article>
        <div class="history-date">1958</div>
        <article class="history-event">
            <img src="00014.jpg">
            <br>
            <p>Впервые проводятся военные лагерные сборы. На территории МФТИ вводится режим секретности.</p>
        </article>
        <div class="history-date">1958</div>
        <article class="history-event">
            <img src="00014.jpg">
            <br>
            <p>Открыт детский сад МФТИ на 50 человек. Открылось физтеховское кафе «Элита».</p>
        </article>
        <article class="history-event">
            <img src="00014.jpg">
            <br>
            <p>Лев Ландау получил Нобелевскую премию по физике за пионерские теории конденсированных сред и особенно жидкого гелия. </p>
        </article>
        <article class="history-event">
            <img src="00014.jpg">
            <br>
            <p>Ректором МФТИ назначен Олег Михайлович Белоцерковский.
                4 февраля проведена первая всесоюзная олимпиада МФТИ для школьников, в ней приняли участие более 600 человек.
                28 октября 1962 — студенты МФТИ состязались в КВН с МИФИ, встреча закончилась победой Физтеха со счетом 77:38.
            </p>
        </article>
    </div>



    <div class="customNavigation">
        <a class="btn prev">Previous</a>
        <a class="btn next">Next</a>
        <a class="btn play">Autoplay</a>
        <a class="btn stop">Stop</a>
    </div>
    <div class="button next"></div>
    <div class="button prev"></div>-->
    <main>
            <div class="top-menu">
                <a href="index.html">на главную</a>
                <a>история</a>
                <a href="faces.html">лица</a>
                <a>карта</a>
            </div>

    <div id="visualization"></div>
    <div class="flex-container">
    <article class="event" id="events">

    </article>
    </div>

    <article class="timeline-event">
        <header></header>
        <div class="event-text"></div>
        <div id="history-slider-2" class="owl-carousel owl-theme"></div>
    </article>
<!--    <div class="arrow">
        <svg width="580" height="400" xmlns="http://www.w3.org/2000/svg">
            &lt;!&ndash; Created with Method Draw - http://github.com/duopixel/Method-Draw/ &ndash;&gt;
            <g>
                <path id="svg_5" d="m97.5,240.5" opacity="0.5" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="#000" fill="none"/>
                <path id="svg_6" d="m464.5,215.5c0,0 -309,1 -309,1c0,0 0,27 0,27c0,0 -43,-42 -43,-42c0,0 38,-41 38,-41c0,0 0,35 0,35c0,0 32,-129 162,-16c159,-116 152,36 152,36z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="#000" fill="none"/>
            </g>
        </svg>
    </div>-->

    </main>
</div>
<script type="text/javascript">


    $(document).ready(function() {

/*        var owl = $("#histry-slider");

        owl.owlCarousel({
            items : 6, //10 items above 1000px browser width
            itemsDesktop : [1000,5], //5 items between 1000px and 901px
            itemsDesktopSmall : [900,3], // betweem 900px and 601px
            itemsTablet: [600,2], //2 items between 600 and 0
            itemsMobile : false // itemsMobile disabled - inherit from itemsTablet option
        });

        // Custom Navigation Events
        $(".next").click(function(){
            owl.trigger('owl.next');
        })
        $(".prev").click(function(){
            owl.trigger('owl.prev');
        })
        $(".play").click(function(){
            owl.trigger('owl.play',5000); //owl.play event accept autoPlay speed as second parameter
        })
        $(".stop").click(function(){
            owl.trigger('owl.stop');
        })

        //$(".history-event").css("width", $(".event-img").css("width"))
        $(".history-event").each(function (i, item) {
            $(this).css("width", $(this).find("img").css("width"))
        })*/

//        var container = document.getElementById('visualization');

/*        // Create a DataSet (allows two way data-binding)
        var items = new vis.DataSet([
            {id: 1, content: 'item 1', start: '2013-04-20'},
            {id: 2, content: 'item 2', start: '2013-04-14'},
            {id: 3, content: 'item 3', start: '2013-04-18'},
            {id: 4, content: 'item 4', start: '2013-04-16', end: '2013-04-19'},
            {id: 5, content: 'item 5', start: '2013-04-25'},
            {id: 6, content: 'item 6', start: '2013-04-27'}
        ]);

        // Configuration for the Timeline
        var options = {};

        // Create a Timeline
        var timeline = new vis.Timeline(container, items, options);

        timeline.on('select', function (properties) {
            //alert('selected items: ' + properties);
            console.log(properties)
            console.log(properties.items[0])
            ShowEvent(properties.items[0]);
        });

        text_1 = "4 декабря 1938 — в газете «Правда» вышла статья «Нужна высшая политехническая школа»."
        text_2 = "<img src='faki.png'>";
        text_3 = "<img src='frtk.png'>";

        function ShowEvent(id) {
            console.log(parseInt(id));
            switch (parseInt(id)) {
                case 1: {
                    $(".event p").html(text_1);
                    $(".event .image").html(text_3);
                    alert(id);
                    break;
                }
                case 2: {
                    $(".event .image").html(text_2);
                }

            }
        }*/

        function initParse(){
            Parse.initialize("kwLWFDHaKExHJguKjRZe8AedJEsUXy7zDJQQdkSd", "jqW5PoPbgeH8U8Q2rHHLKWkoGffEUGXpHaPHZMqv");
        }

        function loadAllEvents(callback){
            var q = new Parse.Query('HistoryEvent');
            q.addDescending('date');
            q.limit(1000);
            q.find({
                success: function (results) {
                    callback(results);
                },
                error: function (error) {
                    alert("Events load error");
                }
            })
        }

        function getEventItemHtml(event){
            img = '';
            if(event.get('eventImage_1') != undefined) {
                console.log(event.get('eventImage_1').url());
                img = event.get('eventImage_1').url();
            }
//            var s = '<div class="eventItem ui message " ><span class="ui label" >' + moment(event.createdAt).format('LLL') + '</span><span class="namePlaceholder" >' + event.get('name') +'<span class="descriptionPlaceholder" > - <span>' + event.get('description') + '</span> <a class="ui button mini basic" href="event.html?id=' + event.id + '" >посмотреть</a></div>';
            var s = '<header>' + event.get('eventTitle') + '</header>' + '<div class="event-wrap"><p>' + event.get('eventDescr') + '</p><img src="' + img + '"></div>';
            return s;
        }

        function drawEvents(events){
            var s = '';
            for (var i in events){
                var e = events[i];
                s+= getEventItemHtml(e);
            }
            $('#events').html(s);
        }

        initParse();
        loadAllEvents(function(events){
            //drawEvents(events);
        });

        var container = document.getElementById('visualization');

        var options = {
            height: '160px',
            start: '1935-01-01',
            end: '1970-12-31',
            editable: false,
            showCurrentTime: true,
            min: new Date(1935, 1, 1),
            max: new Date(2020, 12, 31),
            zoomMin: 1000 * 60 * 60 * 24 * 31,
            zoomMax: 1000 * 60 * 60 * 24 * 31 * 12 * 15
        };
        var items = new vis.DataSet(options);

        loadAllEvents(function (es) {
            for (var i in es) {
                console.log(moment(es[i].get('date')).format());
                console.log(es[i].get('eventTitle'));

                items.add([
                    {id: es[i].id, content: es[i].get('eventTitle'), start: moment(es[i].get('date')).format()}
                ]);
                //console.log(items);
            }
        });

        // Create a Timeline
        var timeline = new vis.Timeline(container, items, options);

/*        timeline.setSelection(1, {
            focus: false
        });*/

        timeline.on('select', function (properties) {
            //alert('selected items: ' + properties);
            console.log(properties)
            console.log(properties.items[0])
            $(".flex-container").css("display", "flex");
            ShowEvent(properties.items[0]);
        });

        events_s = undefined;
        loadAllEvents(function (es) {
            events_s = es;
            console.log(events_s[1].id);
        });



        function ShowEvent(id) {
            console.log(id);
            for(var i in events_s) {
                console.log(events_s[i].id.localeCompare(id));
                if(events_s[i].id.localeCompare(id) === 0) {
                    console.log(events_s[i].id);
                    s = getEventItemHtml(events_s[i]);
                    $('#events').html(s);
                }
            }

        }

    });


</script>
</body>
</html>

<!--
to do list
убрать эффект посещенной ссылки, переделать sapere aude, сделать что-то с прозрачностью шапки,-->
